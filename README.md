# Secure REST API (Spring Boot)
–ó–∞—â–∏—â—ë–Ω–Ω–æ–µ –≤–µ–±-API –Ω–∞ Spring Boot —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π JWT, –∑–∞—â–∏—Ç–æ–π –æ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º best practices –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ stateless REST API, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ:

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ JWT-—Ç–æ–∫–µ–Ω—ã
–ó–∞—â–∏—â—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–µ–π –≤–≤–æ–¥–∞
–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

Spring Boot 3.2 + Gradle
Spring Security + JWT
Spring Data JPA (—Å H2 –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
BCrypt –¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
`POST /auth/login`
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT-—Ç–æ–∫–µ–Ω.

–ó–∞–ø—Ä–æ—Å:

```json
{
"username": "admin",
"password": "securePassword123"
}
```

–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200 OK):
```json
{
"token": "eyJhbGciOiJIUzI1NiJ9.xxxxx"
}
```

–û—à–∏–±–∫–∏:

401 Unauthorized ‚Äî –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìä –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
`GET /api/data`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤. –¢—Ä–µ–±—É–µ—Ç JWT-—Ç–æ–∫–µ–Ω.

–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```
Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>
```

–û—Ç–≤–µ—Ç (200 OK):

```json
[
{
"id": 1,
"title": "Welcome to Secure API",
"content": "This is a protected post..."
}
]
```

`POST /api/posts`
–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –ø–æ—Å—Ç.

–ó–∞–ø—Ä–æ—Å:
```json
{
"title": "My Post",
"content": "Post content here"
}
```

–û—Ç–≤–µ—Ç (200 OK):

```json
{
"id": 2,
"title": "My Post",
"content": "Post content here"
}
```

## üõ°Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã
1. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (SQLi)
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Spring Data JPA (H4) —Å ORM.
   –î–∞–∂–µ –ø—Ä–∏ –≤–≤–æ–¥–µ ' OR '1'='1 ‚Äî –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –ª–∏—Ç–µ—Ä–∞–ª, –∞ –Ω–µ SQL-–∫–æ–¥.
   ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã.

2. –ó–∞—â–∏—Ç–∞ –æ—Ç XSS (Cross-Site Scripting)
   –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (title, content) —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ HTML-—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `org.apache.commons:commons-text`

–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ HTML/JS.
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–∏ –≤–≤–æ–¥–µ <script>alert(1)</script> –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç &lt;script&gt;alert(1)&lt;/script&gt;.

3. –ó–∞—â–∏—Ç–∞ –æ—Ç Broken Authentication
   –ü–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é BCrypt (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π, —Å —Å–æ–ª—å—é).
   –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ ‚Äî –¥–∞–∂–µ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–∞—Ä–æ–ª–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é).
   –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT:
   –¢–æ–∫–µ–Ω –≤—ã–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ª–æ–≥–∏–Ω–µ.
   –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ ‚Äî 24 —á–∞—Å–∞.
   –ü–æ–¥–ø–∏—Å—å ‚Äî HMAC-SHA256 —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º.
   –í—Å–µ /api/** —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã middleware, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–º JWT.
   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è stateless-—Ä–µ–∂–∏–º (SessionCreationPolicy.STATELESS) ‚Üí CSRF –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º.
   ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–∞–¥—ë–∂–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–µ–∑ —É—Ç–µ—á–µ–∫ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–¥–∞ (SAST)
   –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è SpotBugs:
   SECELEAK ‚Äî JPA-—Å—É—â–Ω–æ—Å—Ç–∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è DTO).
   SECHCP ‚Äî –ø–∞—Ä–æ–ª–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –∏–∑ –∫–æ–¥–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
   SPRING_CSRF_PROTECTION_DISABLED ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ CSRF –æ–±–æ—Å–Ω–æ–≤–∞–Ω–æ –¥–ª—è JWT API.
   
## SpotBugs (SAST)
SpotBugs Report

‚úÖ 0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π ‚Äî –≤—Å–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã.
<img src="./im132.png"/>